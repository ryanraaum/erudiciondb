% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/interface.R
\name{.match_person}
\alias{.match_person}
\title{Match item_person data to focal persons using hierarchical strategies}
\usage{
.match_person(
  connection,
  pdata,
  only_most_recent = TRUE,
  only_active_stage = TRUE
)
}
\arguments{
\item{connection}{Database connection or pool}

\item{pdata}{List with person data containing: family, given, orcid (optional), literal (optional)}

\item{only_most_recent}{Use only latest revision of persons (default: TRUE)}

\item{only_active_stage}{Use only active persons (stage=0) (default: TRUE)}
}
\value{
Data frame with matched person(s) plus similarity and found_by columns,
or empty data frame if no match
}
\description{
Attempts to match a person from imported bibliography data (item_person) to an
existing focal person in the persons table using four prioritized matching strategies.
}
\details{
\strong{Hierarchical matching algorithm} (stops at first match):
\enumerate{
\item \strong{ORCID exact match}: If pdata has orcid, match on orcid field (found_by = "orcid")
\item \strong{Full name exact match}: Match primary_given_names + surnames, or ASCII variants
(found_by = "full_name_match")
\item \strong{Initials + surname match}: Match initials extracted from given name plus surname,
checking both primary and ASCII variants (found_by = "initials_match")
\item \strong{Approximate name match}: Fuzzy match using Jaro-Winkler distance on first word
of given name + surname, threshold < 0.05 distance (found_by = "approximate_name_match")
}

All exact matches return similarity=1.0. Approximate matches return
similarity = 1 - mean(given_distance, family_distance).
}
\note{
\itemize{
\item Only matches actual people - institutional authors (literal without family/given) return NULL
\item Requires at least family OR given name to attempt matching
\item Pulls full persons table into memory (assumes small size for intended use cases)
\item ASCII transliteration handles accented characters (e.g., José → jose)
\item If multiple persons match, all are returned (caller handles ambiguity)
}
}
\keyword{internal}
